<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Set使用</title>
    <script src="../js/traceur.js"></script>
    <script src="../js/BrowserSystem.js"></script>
    <script src="../js/bootstrap.js"></script>
</head>

<body>
    <h1>Set使用</h1>
    <script type="module">
        console.info("//---------------------------------------------------------------------");
        console.info("// [1] 基本用法");
        console.info("//---------------------------------------------------------------------");
        console.info("");

        console.info("Set本身是一个构造函数，用来生成Set数据结构。Set结构不会添加重复的值。");
        var set = new Set();
        [2, 3, 5, 4, 5, 2, 2].map(x => set.add(x));
        for (let i of set) {
            console.log(i);
        }

        console.info("Set函数可以接受一个数组（或类似数组的对象）作为参数，用来初始化。");
        var set2 = new Set([1, 2, 3, 4, 4]);
        console.log([...set2]); // [1, 2, 3, 4]
        console.log(set2.size); // 4

        console.info("向Set加入值的时候，不会发生类型转换，所以5和\"5\"是两个不同的值。");
        var set3 = new Set([1, "1", 2, 2]);
        console.log([...set3]);

        console.info("在Set内部，两个NaN是相等。");
        let set4 = new Set();
        let a = NaN;
        let b = NaN;
        set4.add(a);
        set4.add(b);
        console.log([...set4]);

        console.info("由于两个空对象不相等，所以它们被视为两个值。");
        let set5 = new Set();

        set5.add({});
        console.log(set5.size); // 1

        set5.add({});
        console.log(set5.size); // 2

        console.info("//---------------------------------------------------------------------");
        console.info("");
    </script>
    <script type="module">
        console.info("//---------------------------------------------------------------------");
        console.info("// [2] Set实例的属性和方法");
        console.info("//---------------------------------------------------------------------");
        console.info("");

        console.info("语法");
        let set = new Set();
        set.add(1).add(2).add(2);
        console.log(set.size);   // 2

        console.log(set.has(1)); // true
        console.log(set.has(2)); // true
        console.log(set.has(3)); // false

        console.log(set.delete(2)); // true
        console.log(set.has(2));    // false

        console.info("将Set结构转为数组");
        let items = new Set([1, 2, 3, 4, 5]);
        console.info("=>方法1");
        console.log([...items]);

        console.info("=>方法2");
        console.log(Array.from(items));

        console.info("//---------------------------------------------------------------------");
        console.info("");
    </script>
    <script type="module">
        console.info("//---------------------------------------------------------------------");
        console.info("// [3] 遍历操作");
        console.info("//---------------------------------------------------------------------");
        console.info("");

        let set = new Set(['red', 'green', 'blue']);

        for (let item of set.keys()) {
            console.log(item);
        }

        for (let item of set.values()) {
          console.log(item);
        }

        for (let item of set.entries()) {
          console.log(item);
        }

        for (let x of set) {
            console.log(x);
        }

        set.forEach((key, value) => console.log(value));

        console.info("//---------------------------------------------------------------------");
        console.info("");
    </script>

    <script type="module">
        console.info("//---------------------------------------------------------------------");
        console.info("// [4] 应用场景");
        console.info("//---------------------------------------------------------------------");
        console.info("");

        {
            console.info("=>set转化array");
            let set = new Set(['red', 'green', 'blue']);
            let arr = [...set];
            console.log(arr);
        }

        {
            console.info("=>array转化set");
            let arr = ['red', 'green', 'blue'];
            let set = new Set(arr);
            console.log(set);
        }

        {
            console.info("=>数组的map和filter方法也可以用于Set");
            let set = new Set([1, 2, 3, 4, 5, 6, 7, 8, 9, 10]);
            let set2 = new Set([...set].map(x => x + 10));
            console.log(set2);

            let set3 = new Set([...set].filter(x => (x % 2) == 0));
            console.log(set3);
        }

        {
            console.info("=>并集（Union）、交集（Intersect）和差集");
            let a = new Set([1, 2, 3]);
            let b = new Set([4, 3, 2]);

            // 并集
            let union = new Set([...a, ...b]);
            console.log(union);
            // Set {1, 2, 3, 4}

            // 交集
            let intersect = new Set([...a].filter(x => b.has(x)));
            console.log(intersect);
            // set {2, 3}

            // 差集
            let difference = new Set([...a].filter(x => !b.has(x)));
            console.log(difference);
            // Set {1}
        }


        console.info("//---------------------------------------------------------------------");
        console.info("");
    </script>
</body>

</html>
